<!-- Template: HomeDetailCharts.inc.html -->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    // Load the Visualization API and the corechart package.
    google.charts.load('current', {'packages': ['corechart']});

    // Set a callback to run when the Google Visualization API is loaded.
    google.charts.setOnLoadCallback(drawChart);

    // Callback that creates and populates a data table,
    // instantiates the pie chart, passes in the data and
    // draws it.
    function drawChart() {

        var engineerID = {engineerID};
        var startDate = new Date('{startDate}');
        var endDate = new Date('{endDate}');
        this.ajaxOptions = {
            url: '{dataFetchUrl}',
            dataType: 'json',
            mehtod: 'POST',
            data: {
                engineerID: engineerID,
                startDate: startDate.toISOString(),
                endDate: endDate.toISOString()
            }
        };
        this.data = $.ajax(this.ajaxOptions).then(function (result) {


            var data = new google.visualization.DataTable();
            data.addColumn('date', 'Dates');
            data.addColumn('number', 'Hours Logged');
            data.addColumn('number', 'Average over 5 days');
            data.addColumn('number', 'Average over Month');

            data.addRows(
                result.map(function (row) {
                    return [
                        new Date(row['loggedDate']),
                        row['loggedHours'],
                        row['fiveDaysAvg'],
                        row['monthAvg']
                    ]
                })
            );

// Set chart options
            var options = {
                'title': 'Time Logged',
                seriesType: 'bars',
                series: {
                    1: {type: 'line'},
                    2: {type: 'line'}
                },
                legend: {
                    position: 'bottom'
                }
            };

// Instantiate and draw our chart, passing in some options.
            var chart = new google.visualization.ComboChart(document.getElementById('chart_div'));
            chart.draw(data, options);


            var data2 = new google.visualization.DataTable();
            data2.addColumn('date', 'Dates');
            data2.addColumn('number', '% Last 5 days');
            data2.addColumn('number', '% Last Month');
            data2.addColumn('number', 'Target %');

            data2.addRows(
                result.map(function (row) {
                    return [
                        new Date(row['loggedDate']),
                        row['fiveDaysTotal'] / row['fiveDaysToLog'] * 100,
                        row['monthTotal'] / row['monthToLog'] * 100,
                        row['target']
                    ]
                })
            );

// Set chart options
            var options2 = {
                'title': 'Time Logged',
                seriesType: 'line',
                series: {
                    1: {type: 'line'},
                    2: {type: 'line'}
                },
                legend: {
                    position: 'bottom'
                }
            };

// Instantiate and draw our chart, passing in some options.
            var chart2 = new google.visualization.ComboChart(document.getElementById('chartTarget'));
            chart2.draw(data2, options2);


        });

// Create the data table.

    }
</script>
<div id="chart_div"></div>
<div id="chartTarget">

</div>
<!-- Template: HomeDetailCharts.inc.html -->