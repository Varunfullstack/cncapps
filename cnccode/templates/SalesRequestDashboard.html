<script>
    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.userAllocation').forEach((elm) => {
            elm.addEventListener('change', ($event) => {
                const select = $event.target;
                const userId = $event.target.value || null;
                const problemId = select.dataset.problemId;

                fetch('?action=assignUser', {
                    method: 'POST',
                    body: JSON.stringify({
                        problemId,
                        userId
                    })
                })
            })
        })
    })
</script>
<table class="oddRows">
    <thead>
    <tr>
        <th>
            Customer Name
        </th>
        <th>
            SR Link
        </th>
        <th>
            Sales Request
        </th>
        <th>
            Requested By
        </th>
        <th>
            Requested Date & Time
        </th>
        <th>
            Attachments
        </th>
        <th>
            Type
        </th>
        <th>
            Assigned To
        </th>
    </tr>
    </thead>
    <tbody>
    <!-- BEGIN SalesRequestsBlock -->
    <tr class="topAlign">
        <td>
            {customerName}
        </td>
        <td>
            {srLink}
        </td>
        <td>
            {salesRequest}
        </td>
        <td>
            {requestedBy}
        </td>
        <td>
            {requestedDateTime}
        </td>
        <td>
            {attachments}
        </td>
        <td>{type}</td>
        <td>
            <select class="userAllocation"
                    data-problem-id="{problemId}"
            >{engineerDropDown}</select>
        </td>
        <td>
            {processCRLink}
        </td>
    </tr>
    <!-- END SalesRequestsBlock -->
    </tbody>
</table>