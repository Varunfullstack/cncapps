<script>

    const autocompleteURL = "/Customer.php?action=searchName";
    $(function () {
        $('#customerString').autocomplete({
            minLength: 0,
            source: function (request, responseCB) {
                const data = {};
                data.term = request.term;
                $.ajax(
                    autocompleteURL,
                    {
                        method: 'POST',
                        dataType: 'json',
                        data: data
                    }
                ).then(response => {
                    responseCB(response.map(item => ({label: item.name, value: item.id})));
                })
            },
            select: function (event, ui) {
                event.preventDefault();
                event.target.value = ui.item.label;
                $('#customerID').val(ui.item.id);
            },
            delay: 200,
        }).focus(function () {
            $(this).autocomplete("search", $(this).val());
        });
    });
    function clearForm() {
        document.createTemplatedQuotationForm.reset();
    }

    const openTabURL = '{openTabURL}';
    if (openTabURL) {
        window.open(openTabURL, '_blank').focus();
    }

</script>
<form method="post"
      action=""
      name="createTemplatedQuotationForm"
>
    <table>
        <tbody>
        <tr>
            <td class="promptText">Customer:</td>
            <td>
                <input type="hidden"
                       name="form[customerID]"
                       id="customerID"
                       value="{customerID}"
                >
                <input type="text"
                       name="form[customerString]"
                       id="customerString"
                       value="{customerString}"
                       size="50"
                       maxlength="50"
                >
            </td>
        </tr>
        <tr>
            <td class="promptText">Template:</td>
            <td>
                <select name="form[templates][]"
                        multiple
                        required
                        size="20"
                >
                    <!-- BEGIN templatesBlock -->
                    <option value="{templateID}"
                            {selected}
                    >{description}
                    </option>
                    <!-- END templatesBlock -->
                </select>
            </td>
        </tr>
        <tr>
            <td class="promptText">Existing Quotation</td>
            <td>
                <input type="text"
                       value="{existingQuotationID}"
                       name="form[existingQuotationID]"
                >
            </td>
        </tr>
        </tbody>
    </table>
    <button>Create</button>
    <button type="button"
            onclick="clearForm();"
    >Clear
    </button>
</form>
