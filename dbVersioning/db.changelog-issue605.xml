<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">
    <changeSet author="pavwebdev" id="1563960329-0">
        <tagDatabase tag="issue605"/>
    </changeSet>
    <changeSet author="pavwebdev" id="1563960329-1">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="quotationTemplate"/>
            </not>
        </preConditions>
        <createTable tableName="quotationTemplate">
            <column name="id" type="int(11)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="linkedSalesOrderId" type="int(11)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="text"/>
            <column name="sortOrder" type="int(11)" defaultValue="0"/>
        </createTable>
        <rollback>
            <dropTable tableName="quotationTemplate"/>
            <sql>
                delete
                from db_sequence
                where seq_name = "quotationTemplate"
            </sql>
        </rollback>
    </changeSet>
    <changeSet author="pavwebdev" id="1563960329-2">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="1">
                select cus_name = "CNC Test Customer" from customer where cus_custno = 420
            </sqlCheck>
        </preConditions>
        <sql>
            update customer set cus_name = "CNC Template Customer" where cus_custno = 420
        </sql>
        <rollback>
            <sql>
                update customer set cus_name = "CNC Test" where cus_custno = 420
            </sql>
        </rollback>
    </changeSet>
    <changeSet author="pavwebdev" id="1563960329-3">
        <preConditions onFail="MARK_RAN">
            <not>
                <indexExists tableName="quotationTemplate" indexName="quotationTemplate_description_full_index"/>
            </not>
        </preConditions>
        <createIndex indexName="quotationTemplate_description_full_index" tableName="quotationTemplate">
            <column name="description"/>
        </createIndex>
    </changeSet>

</databaseChangeLog>